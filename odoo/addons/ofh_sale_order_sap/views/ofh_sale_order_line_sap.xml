<?xml version="1.0" encoding="utf-8"?>
<!-- Copyright 2019 Tajawal LLC
     License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl). -->

<odoo>
    <record model="ir.actions.server" id="ofh_sale_order_line_sap_skipped">
        <field name="name">Mark Sale Order as Not Applicable</field>
        <field name="model_id" ref="model_ofh_sale_order_line_sap"/>
        <field name="binding_model_id" ref="model_ofh_sale_order_line_sap"/>
        <field name="state">code</field>
        <field name="code">
if records:
    records.action_mark_order_as_not_applicable()
        </field>
    </record>

    <record id="action_hotel_skipped_sap_sale_order_lines" model="ir.actions.act_window">
        <field name="name">Hotel Skipped Lines</field>
        <field name="res_model">ofh.sale.order.line.sap</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('sale_order_line_id.line_type', '=', 'hotel'), ('sap_sale_order_id.failing_reason', '=', 'skipped')]</field>
        <field name="context">{'search_default_sent_this_week': 1}</field>
    </record>

    <record model="ir.ui.menu" id="action_hotel_skipped_sap_sale_order_lines_line_menu">
        <field name="name">Hotel Skipped Lines</field>
        <field name="parent_id" ref="ofh_sale_order_sap_menu"/>
        <field name="action" ref="action_hotel_skipped_sap_sale_order_lines"/>
        <field name="sequence" eval="20"/>
    </record>

    <record model="ir.ui.view" id="hotel_skipped_sap_sale_order_lines_tree_view">
        <field name="name">ofh.sale.order.line.sap.tree (in ofh_sale_order_line_sap)</field>
        <field name="model">ofh.sale.order.line.sap</field>
        <field name="arch" type="xml">
            <tree edit="0" create="0" delete="0">
                <field name="order_number"/>
                <field name="track_id"/>
                <field name="failing_text"/>
                <field name="created_at"/>
                <field name="hotel_id"/>
                <field name="hotel_supplier_id"/>
                <field name="supplier_name"/>
                <field name="hotel_name"/>
                <field name="hotel_contract_name"/>
                <field name="hotel_country"/>
                <field name="send_date"/>
            </tree>
        </field>
    </record>

    <record model="ir.ui.view" id="hotel_skipped_sap_sale_order_lines_search_view">
        <field name="name">ofh.sale.order.line.sap.search (in ofh_sale_order_sap)</field>
        <field name="model">ofh.sale.order.line.sap</field>
        <field name="arch" type="xml">
            <search>
                <filter name="sent_this_month" string="Sent This month"
                        domain="[('send_date', '&gt;=', context_today().strftime('%%Y-%%m-01'))]"/>
                <filter name="sent_this_week" string="Sent this week"
                        domain="['&amp;', ('send_date', '&gt;=', (context_today() - relativedelta(days=7)).strftime('%Y-%m-%d')), ('send_date', '&lt;=', context_today().strftime('%Y-%m-%d'))]"/>
                <separator/>
            </search>
        </field>
    </record>

    <record model="ir.ui.view" id="ofh_sale_order_line_sap_form_view">
        <field name="name">ofh.sale.order.line.sap.form (in ofh_sale_order_line_sap)</field>
        <field name="model">ofh.sale.order.line.sap</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <group name="general" col="4">
                        <field name="is_double_hoop"/>
                        <field name="sap_sale_order_id" invisible="1"/>
                        <field name="payment_request_id" invisible="1"/>
                    </group>
                    <group name="item_general" string="Item General" col="4">
                        <field name="booking_line_item_flag"/>
                        <field name="booking_line_item_number"/>
                        <field name="line_item_billing_block"/>
                        <field name="segment"/>
                        <field name="service_item"/>
                        <field name="qty"/>
                        <field name="billing_date"/>
                        <field name="plant"/>
                        <field name="vat_tax_code"/>
                        <field name="airline_code"/>
                        <field name="iata_number"/>
                        <field name="domestic_international"/>
                        <field name="vendor"/>
                        <field name="vendor2"/>
                        <field name="travel_order_number"/>
                        <field name="ticket_number"/>
                        <field name="pnr"/>
                        <field name="gds_code"/>
                        <field name="lcc_ind"/>
                        <field name="vendor_confirmation"/>
                        <field name="segment_count"/>
                        <field name="custom1"/>
                        <field name="pax_name"/>
                    </group>
                    <notebook>
                        <page name="flight_item_characteristics" string="Item Characteristics">
                            <group name="item_characteristics" col="4">
                                <field name="z_airlinecode"/>
                                <field name="z_fare_class"/>
                                <field name="z_booking_type"/>
                                <field name="z_booking_class"/>
                                <field name="z_lastlegflyingdate"/>
                                <field name="z_paxname"/>
                                <field name="z_vendor"/>
                                <field name="z_destinationcity"/>
                                <field name="z_locater"/>
                                <field name="z_tktstatus"/>
                                <field name="z_owneroid"/>
                                <field name="z_departuredate"/>
                                <field name="z_route"/>
                                <field name="z_iata"/>
                                <field name="z_numberofpax"/>
                                <field name="z_suppliername_h"/>
                                <field name="z_numberofnights"/>
                                <field name="z_numberofrooms"/>
                                <field name="z_startdate"/>
                                <field name="z_checkout"/>
                                <field name="z_provider_h"/>
                                <newline/>
                                <field name="z_seg1origin"/>
                                <field name="z_seg1destination"/>
                                <field name="z_seg2origin"/>
                                <field name="z_seg2destination"/>
                                <field name="z_seg3origin"/>
                                <field name="z_seg3destination"/>
                                <field name="z_seg4origin"/>
                                <field name="z_seg4destination"/>
                                <field name="z_seg5origin"/>
                                <field name="z_seg5destination"/>
                                <field name="z_seg6origin"/>
                                <field name="z_seg6destination"/>
                                <field name="z_seg7origin"/>
                                <field name="z_seg7destination"/>
                                <field name="z_seg8origin"/>
                                <field name="z_seg8destination"/>
                                <field name="z_seg9origin"/>
                                <field name="z_seg9destination"/>
                                <field name="z_serialnumber"/>
                            </group>
                        </page>
                         <page name="item_conditions" string="Item Conditions">
                            <group name="item_conditions" col="4">
                                <field name="zsel"/>
                                <field name="zvd1"/>
                                <field name="zvnr"/>
                                <field name="zvt1"/>
                                <field name="zgds"/>
                                <field name="zdis"/>
                            </group>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>
    <!-- Flight Skipped Lines-->
    <record model="ir.ui.view" id="flight_skipped_sap_sale_order_lines_tree_view">
        <field name="name">ofh.sale.order.line.sap.tree (in ofh_sale_order_line_sap)</field>
        <field name="model">ofh.sale.order.line.sap</field>
        <field name="arch" type="xml">
            <tree edit="0" create="0" delete="0">
                <field name="order_number"/>
                <field name="track_id"/>
                <field name="failing_text"/>
                <field name="created_at"/>
                <field name="office_id"/>
                <field name="supplier_name"/>
                <field name="vendor_name"/>
                <field name="send_date"/>
            </tree>
        </field>
    </record>
    <record id="action_flight_skipped_sap_sale_order_lines" model="ir.actions.act_window">
        <field name="name">Flight Skipped Lines</field>
        <field name="res_model">ofh.sale.order.line.sap</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('sale_order_line_id.line_type', '=', 'flight'), ('sap_sale_order_id.failing_reason', '=', 'skipped')]</field>
        <field name="context">{'search_default_sent_this_week': 1}</field>
    </record>
     <record id="action_flight_skipped_sap_sale_order_lines" model="ir.actions.act_window">
        <field eval="1" name="sequence"/>
        <field name="view_mode">tree,form</field>
        <field name="view_id" ref="flight_skipped_sap_sale_order_lines_tree_view"/>
        <field name="act_window_id" ref="action_flight_skipped_sap_sale_order_lines"/>
    </record>
    <record model="ir.ui.menu" id="action_flight_skipped_sap_sale_order_lines_line_menu">
        <field name="name">Flight Skipped Lines</field>
        <field name="parent_id" ref="ofh_sale_order_sap_menu"/>
        <field name="action" ref="action_flight_skipped_sap_sale_order_lines"/>
        <field name="sequence" eval="30"/>
    </record>


</odoo>
